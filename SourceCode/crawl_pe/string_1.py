import os
import json
import csv
import string

def extract_printable_strings(json_file_path):
    with open(json_file_path, 'r', encoding='utf-8') as json_file:
        data = json.load(json_file)
        printable_strings = []
        if 'strings' in data:
            for string_item in data['strings']:
                # Filter out non-printable characters
                printable_string = ''.join(filter(lambda x: x in string.printable, string_item))
                printable_strings.append(printable_string)
        return printable_strings

def save_to_csv(file_path, data):
    with open(file_path, 'a', newline='', encoding='utf-8') as csv_file:
        writer = csv.writer(csv_file)
        writer.writerow(data)

def process_folder(folder_path):
    csv_file_path = os.path.join(folder_path, "unknown2.csv")  # Tên của file CSV kết quả
    for root, dirs, files in os.walk(folder_path):
        for file_name in files:
            if file_name.endswith('.json'):
                json_file_path = os.path.join(root, file_name)
                printable_strings = extract_printable_strings(json_file_path)
                save_to_csv(csv_file_path, printable_strings)

folder_path = "out_put\\unknown2"
process_folder(folder_path)
print("Conversion completed.")